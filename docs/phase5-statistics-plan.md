# Phase 5: 통계 페이지 계획서

## 1. 개요

### 배경
현재 대시보드(`dashboard.vue`, 1,445줄)에 모든 통계 요소가 밀집되어 있어:
- 스크롤이 매우 길어 핵심 정보를 빠르게 파악하기 어려움
- "오늘의 현황"과 "분석용 통계"가 혼재
- 미용실/네일샵 사장님이 매일 확인해야 할 정보와, 주기적으로 분석하는 정보가 구분되지 않음

### 목표
1. **대시보드 경량화**: 오늘 중심 핵심 정보만 남기기 (알림 + 오늘 통계 + 퀵액션)
2. **통계 페이지 신설**: 기간별 심층 분석 기능을 별도 페이지로 분리
3. **새로운 분석 차트 추가**: 시간대별 히트맵, 매출 추이, 고객 증감 등

---

## 2. 대시보드 재구성

### 대시보드에 유지할 요소 (오늘 + 실시간)
| # | 요소 | 이유 |
|---|------|------|
| 1 | 온보딩 위저드 | 신규 사용자 첫 경험 |
| 2 | 환영 메시지 | 개인화 인사 + 날짜 확인 |
| 3 | 미배정 예약 알림 | 즉시 조치 필요 |
| 4 | 처리 필요 액션 알림 | 확정 대기, 1시간 내 시작, 생일, 재방문 유도 |
| 5 | 오늘 통계 카드 4개 | 예약, 대기, 예상 매출, 신규 고객 |
| 6 | 이번 주 예약 차트 + 이번 달 요약 | 주간/월간 간단 요약 |
| 7 | 오늘 예약 목록 + 최근 신규 고객 | 실시간 현황 확인 |
| 8 | 퀵 액션 버튼 | 빠른 이동 |

### 통계 페이지로 이동할 요소
| # | 요소 | 대시보드 줄수 | 통계 탭 |
|---|------|--------------|---------|
| 1 | 기간별 통계 (프리셋+차트) | Line 120~275 (~155줄) | 매출 분석 |
| 2 | 목표 달성률 | Line 277~372 (~95줄) | 매출 분석 |
| 3 | 취소/노쇼 현황 | Line 414~467 (~53줄) | 예약 분석 |
| 4 | 고객 세그먼트 분석 | Line 469~573 (~104줄) | 고객 분석 |
| 5 | 인기 서비스 TOP 5 | Line 575~618 (~43줄) | 서비스 분석 |
| 6 | 직원 성과 TOP 3 | Line 620~671 (~51줄) | 직원 분석 |
| 7 | 평균 지표 | Line 673~736 (~63줄) | 매출 분석 |

**예상 대시보드 줄수**: 1,445줄 → ~800줄 (약 45% 감소)

### 대시보드에 추가할 요소
- "통계 바로가기" 버튼 (퀵 액션 영역 또는 환영 메시지 옆)

---

## 3. 통계 페이지 구조

### 3.1 페이지 위치
- **경로**: `src/pages/shop-admin/statistics/index.vue`
- **라우트**: `/shop-admin/statistics`
- **라우트 이름**: `shop-admin-statistics`
- **네비게이션**: 대시보드 바로 아래, 아이콘 `ri-bar-chart-box-line`

### 3.2 페이지 레이아웃

```
┌─────────────────────────────────────────────────────────────────┐
│ [통계 분석]                              [기간 필터: 이번 달 v] │
│                                                                 │
│ ┌─────────┬──────────┬──────────┬──────────┬──────────┐        │
│ │ 매출분석 │ 예약분석 │ 고객분석 │ 직원성과 │ 서비스분석│        │
│ └─────────┴──────────┴──────────┴──────────┴──────────┘        │
│                                                                 │
│ [탭별 콘텐츠 영역]                                              │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 3.3 공통 필터 바 (모든 탭에 적용)

```
┌────────────────────────────────────────────────────────────┐
│ [오늘] [이번주] [이번달] [지난달] [3개월] [6개월] [1년]     │
│                                                            │
│ 시작일: [____] ~ 종료일: [____]  비교: [이전기간 v] [조회] │
└────────────────────────────────────────────────────────────┘
```

---

## 4. 탭별 상세 설계

### Tab 1: 매출 분석

```
┌──────────────────────────────────────────────────┐
│ 핵심 지표 카드 (4개)                              │
│ [총 매출] [평균 매출] [객단가] [목표 달성률]       │
│ ↕ 전기간 대비 변화율                              │
├──────────────────────────────────────────────────┤
│ 매출 추이 차트 (Line + Bar 혼합, md=8)            │
│ - X축: 날짜                                      │
│ - Y축(좌): 예약건수(Bar)                          │
│ - Y축(우): 매출(Line)                             │
│                                                   │
│ 목표 달성률 (RadialBar, md=4)                     │
│ - 매출 목표 진행률                                │
│ - 예약 목표 진행률                                │
│ - 잔여일 표시                                     │
├──────────────────────────────────────────────────┤
│ 서비스별 매출 비중 (Donut, md=5)                   │
│ - TOP 5 서비스 + 기타                             │
│                                                   │
│ 결제수단별 비중 (Donut, md=3)                     │
│ - 카드, 현금, 이체 등                             │
│                                                   │
│ 평균 지표 카드 (md=4)                             │
│ - 평균 예약 금액                                  │
│ - 평균 서비스 시간                                │
│ - 완료 전환율                                     │
│ - 고객 LTV                                       │
└──────────────────────────────────────────────────┘
```

**차트 유형**:
- 매출 추이: `ApexCharts` (bar + line 혼합, 기존 대시보드 코드 재활용)
- 목표 달성률: `ApexCharts` RadialBar
- 서비스별 매출: `ApexCharts` Donut
- 결제수단별: `ApexCharts` Donut

### Tab 2: 예약 분석

```
┌──────────────────────────────────────────────────┐
│ 핵심 지표 카드 (4개)                              │
│ [총 예약] [완료] [취소] [노쇼]                     │
│ ↕ 전기간 대비 변화율                              │
├──────────────────────────────────────────────────┤
│ 예약 추이 차트 (Bar, md=8)                        │
│ - 일별/주별 예약건수                              │
│ - 상태별 스택 (완료/취소/노쇼)                     │
│                                                   │
│ 예약 상태 분포 (Donut, md=4)                      │
│ - 완료/취소/노쇼/대기 비율                         │
├──────────────────────────────────────────────────┤
│ 시간대별 예약 히트맵 (Heatmap, 전체 너비)          │
│ - X축: 시간 (09:00 ~ 21:00)                      │
│ - Y축: 요일 (월 ~ 일)                            │
│ - 색상 농도: 예약건수                              │
├──────────────────────────────────────────────────┤
│ 취소/노쇼 현황 (md=6)                             │
│ - 취소 건수/비율                                  │
│ - 노쇼 건수/비율                                  │
│ - 매출 손실액                                     │
│ - 전체 이탈률                                     │
│                                                   │
│ 요일별 예약 분포 (Bar, md=6)                      │
│ - 요일별 평균 예약건수                             │
└──────────────────────────────────────────────────┘
```

**차트 유형**:
- 예약 추이: `ApexCharts` Stacked Bar
- 상태 분포: `ApexCharts` Donut
- 시간대 히트맵: `ApexCharts` Heatmap **(신규)**
- 요일별 분포: `ApexCharts` Bar

### Tab 3: 고객 분석

```
┌──────────────────────────────────────────────────┐
│ 핵심 지표 카드 (4개)                              │
│ [전체 고객] [신규 고객] [재방문율] [평균 방문횟수]  │
│ ↕ 전기간 대비 변화율                              │
├──────────────────────────────────────────────────┤
│ 고객 증감 추이 (Line, md=8)                       │
│ - 신규 고객 수 (Line)                             │
│ - 재방문 고객 수 (Line, 점선)                     │
│                                                   │
│ 고객 세그먼트 (Donut, md=4)                       │
│ - VIP / 단골 / 신규 / 이탈                        │
├──────────────────────────────────────────────────┤
│ 재방문율 추이 (Area, md=6)                        │
│ - 월별 재방문율 변화                               │
│                                                   │
│ 고객 LTV 분포 (Bar, md=6)                         │
│ - 금액 구간별 고객 수                              │
├──────────────────────────────────────────────────┤
│ 고객 세그먼트 상세 리스트 (전체 너비)              │
│ - VIP/단골/신규/이탈 명수 + 칩 + 비율             │
│ - (기존 대시보드 고객 현황 리스트 이동)             │
└──────────────────────────────────────────────────┘
```

**차트 유형**:
- 고객 추이: `ApexCharts` Line (dual)
- 세그먼트: `ApexCharts` Donut
- 재방문율: `ApexCharts` Area
- LTV 분포: `ApexCharts` Bar **(신규)**

### Tab 4: 직원 성과

```
┌──────────────────────────────────────────────────┐
│ 직원 필터: [전체 직원 v]                          │
├──────────────────────────────────────────────────┤
│ 직원 성과 비교 (HorizontalBar, 전체 너비)          │
│ - 직원별 매출 (정렬됨)                            │
│ - 직원별 예약건수 오버레이                         │
├──────────────────────────────────────────────────┤
│ 직원별 상세 카드 (md=4 x 3)                       │
│ ┌─────────────────┐                              │
│ │ 1위 🥇 김디자이너  │                              │
│ │ 예약: 45건        │                              │
│ │ 매출: 3,500,000원 │                              │
│ │ 평균시간: 65분    │                              │
│ │ 고객만족: 4.8★    │                              │
│ └─────────────────┘                              │
├──────────────────────────────────────────────────┤
│ 직원별 서비스 시간 효율 (Radar, md=6)              │
│ - 평균 서비스 시간                                │
│ - 예약 완료율                                     │
│ - 고객 수                                         │
│ - 매출                                           │
│                                                   │
│ 직원별 매출 추이 (Line, md=6)                     │
│ - 선택 직원의 월별 매출 추이                       │
└──────────────────────────────────────────────────┘
```

**차트 유형**:
- 성과 비교: `ApexCharts` Horizontal Bar
- 역량 레이더: `ApexCharts` Radar **(신규)**
- 매출 추이: `ApexCharts` Line

### Tab 5: 서비스 분석

```
┌──────────────────────────────────────────────────┐
│ 핵심 지표 카드 (4개)                              │
│ [총 서비스건수] [인기서비스] [평균단가] [카테고리수]│
├──────────────────────────────────────────────────┤
│ 인기 서비스 순위 (HorizontalBar, md=7)             │
│ - 서비스별 예약건수 (정렬)                         │
│                                                   │
│ 카테고리별 매출 비중 (Donut, md=5)                 │
│ - 카테고리별 비율                                  │
├──────────────────────────────────────────────────┤
│ 서비스별 매출 추이 (Line, 전체 너비)               │
│ - TOP 5 서비스 각각의 월별 매출 추이               │
├──────────────────────────────────────────────────┤
│ 서비스 상세 테이블 (전체 너비)                     │
│ | 순위 | 서비스명 | 카테고리 | 예약수 | 매출 | 비중 | │
│ (기존 인기 서비스 TOP 5 → 전체 서비스로 확대)      │
└──────────────────────────────────────────────────┘
```

**차트 유형**:
- 인기 순위: `ApexCharts` Horizontal Bar
- 카테고리별: `ApexCharts` Donut
- 매출 추이: `ApexCharts` Line (multi-series)

---

## 5. 기술 구현 계획

### 5.1 파일 구조

```
src/
├── pages/shop-admin/statistics/
│   ├── index.vue                    # 메인 통계 페이지 (탭 컨테이너)
│   └── components/
│       ├── StatisticsFilterBar.vue   # 공통 기간 필터
│       ├── RevenueTab.vue           # 매출 분석 탭
│       ├── ReservationTab.vue       # 예약 분석 탭
│       ├── CustomerTab.vue          # 고객 분석 탭
│       ├── StaffTab.vue             # 직원 성과 탭
│       └── ServiceTab.vue           # 서비스 분석 탭
├── api/
│   └── statistics.js                # 통계 전용 API
└── stores/
    └── statistics.js                # 통계 전용 스토어
```

### 5.2 사용 컴포넌트
- `CardStatisticsHorizontal` (Materio) - 핵심 지표 카드
- `VueApexCharts` - 모든 차트 렌더링
- `VTabs` + `VWindow` - 탭 전환
- Vuetify 테마 연동 (`useTheme` + `hexToRgb`)

### 5.3 데이터 흐름

```
index.vue (탭 컨테이너)
  ├── StatisticsFilterBar → emit('filter-change', { startDate, endDate, compareWith })
  └── 각 Tab 컴포넌트
        ├── props: { startDate, endDate, compareWith }
        ├── watch(props) → API 호출
        └── 차트 렌더링
```

### 5.4 네비게이션 변경

```javascript
// navigation/vertical/index.js 에 추가
{
  title: '통계 분석',
  to: { name: 'shop-admin-statistics' },
  icon: { icon: 'ri-bar-chart-box-line' },
  get disabled() {
    const authStore = useAuthStore()
    return authStore.isSuperAdmin && !authStore.hasSelectedBusiness
  },
},
```

위치: 대시보드 바로 아래

---

## 6. 사용자 플로우

### 일상 시나리오 (매일)
1. 로그인 → **대시보드** (오늘 예약, 알림, 빠른 작업)
2. 필요 시 사이드바 → **통계 분석** 클릭

### 분석 시나리오 (주간/월간)
1. 통계 분석 페이지 진입
2. 기간 선택 (이번 달 / 지난 달 / 커스텀)
3. 탭 탐색: 매출 → 예약 → 고객 → 직원 → 서비스
4. 필요한 인사이트 확인

### 대시보드 → 통계 전환 동선
- 대시보드 퀵 액션에 "통계 분석" 버튼 추가
- 대시보드 각 요약 카드에 "자세히 보기" 링크 (통계 해당 탭으로 이동)

---

## 7. 모바일 대응

| 요소 | 데스크탑 | 모바일 |
|------|---------|--------|
| 지표 카드 | `md=3` (4열) | `cols=6` (2열) |
| 차트 2열 | `md=8` + `md=4` | `cols=12` (세로 스택) |
| 히트맵 | 전체 너비 | 전체 너비 + 가로 스크롤 |
| 필터 바 | 가로 1줄 | 세로 스택 |
| 탭 | 가로 탭 | 스크롤 가능한 탭 (`show-arrows`) |

---

## 8. 구현 우선순위

| 순서 | 작업 | 난이도 | 의존성 |
|------|------|--------|--------|
| 1 | 백엔드 API 개발 요청 | - | - |
| 2 | API/Store 레이어 구현 | 낮음 | 백엔드 API 스펙 |
| 3 | 통계 페이지 프레임 (index + 탭 + 필터) | 중간 | - |
| 4 | 매출 분석 탭 | 중간 | API |
| 5 | 예약 분석 탭 | 중간 | API |
| 6 | 고객 분석 탭 | 중간 | API |
| 7 | 직원 성과 탭 | 중간 | API |
| 8 | 서비스 분석 탭 | 중간 | API |
| 9 | 대시보드 경량화 (통계 요소 제거) | 낮음 | 통계 페이지 완성 후 |
| 10 | 네비게이션 + 동선 연결 | 낮음 | 통계 페이지 |
