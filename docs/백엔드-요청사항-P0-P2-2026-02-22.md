# 백엔드 요청사항 - P0~P2 작업 관련 (2026-02-22)

> P0~P2 프론트엔드 작업 진행 중 확인된 백엔드 요청사항 정리

---

## 1. [P1] 프로덕션 환경변수 설정

### 요청 작업
- [ ] CORS 설정: 프로덕션 도메인(yemo.kr) 허용
- [ ] OAuth redirect URI 프로덕션 도메인 등록
  - 카카오 OAuth: `https://yemo.kr/oauth2-redirect`
  - 관리자 로그인: `loginType=admin`
  - 고객 로그인: `loginType=customer`
- [ ] 환경별 API base URL 설정 확인

### 출처
- 미진행-작업-종합 P1-9

---

## 2. [P1] DB 마이그레이션 - VIP 임계값 컬럼 추가

### 요청 작업
- [ ] `businesses` 테이블에 VIP 판별 임계값 컬럼 추가

### 제안 스키마
```sql
ALTER TABLE businesses
  ADD COLUMN vip_visit_threshold INT DEFAULT 10,
  ADD COLUMN vip_spend_threshold DECIMAL(10,2) DEFAULT 500000;
```

### 연관 API
- `GET /api/businesses/{id}` 응답에 `vipVisitThreshold`, `vipSpendThreshold` 필드 포함
- `PUT /api/businesses/{id}` 요청에 임계값 변경 가능하도록

### 출처
- 미진행-작업-종합 P1-10, P2-8

---

## 3. [P1] DB 마이그레이션 - 주소 상세 컬럼 추가

### 요청 작업
- [ ] `businesses` 테이블에 상세 주소 관련 컬럼 추가

### 제안 스키마
```sql
ALTER TABLE businesses
  ADD COLUMN address_detail VARCHAR(255),
  ADD COLUMN zipcode VARCHAR(10);
```

### 연관 API
- `GET /api/businesses/{id}` 응답에 `addressDetail`, `zipcode` 필드 포함
- `PUT /api/businesses/{id}` 요청에서 수정 가능하도록

### 출처
- 미진행-작업-종합 P1-11

---

## 4. [P0] 가격 변경 추가 적용 (법률 문서)

### 변경 내용
프론트엔드에서 다음 법률 문서의 가격도 19,800원(VAT 포함)으로 통일 완료:
- `src/components/legal/TermsContent.vue`: 약관 내 요금 테이블
- `src/pages/refund-policy.vue`: 환불 정책 페이지 (계산 예시 포함)

### 백엔드 확인 필요
- [ ] 환불 일할 계산 로직에서 기준 금액이 `19,800원`으로 반영되었는지 확인
- [ ] 환불 예시 계산:
  - 10일 사용 후 해지 → 19,800 ÷ 30 × 20 = **약 13,200원** 환불
  - 20일 사용 후 해지 → 19,800 ÷ 30 × 10 = **약 6,600원** 환불
  - 25일 사용 후 해지 → 19,800 ÷ 30 × 5 = **약 3,300원** 환불

### 출처
- 이전 백엔드-요청사항-2026-02-22.md 의 가격 변경 후속 작업

---

## 5. [P2] 예약 일괄 상태 변경 API 확인

### 현황
- 프론트엔드에서 `bulkUpdateStatus()` 스토어 메서드 구현 완료
- 예약 목록에서 다건 선택 후 일괄 확정/완료/취소 가능

### 백엔드 확인 필요
- [ ] `PATCH /api/reservations/bulk-status` (또는 유사) 엔드포인트 존재 확인
- [ ] 요청 형식:
```json
{
  "reservationIds": [1, 2, 3],
  "status": "CONFIRMED"  // CONFIRMED | COMPLETED | CANCELLED
}
```
- [ ] 응답: 성공/실패 건수 포함
```json
{
  "successCount": 2,
  "failCount": 1,
  "failures": [
    { "reservationId": 3, "reason": "이미 취소된 예약입니다." }
  ]
}
```

### 출처
- 미진행-작업-종합 P2-2

---

## 6. [P2] 통계 자동 새로고침 관련

### 현황
- 프론트엔드에서 5분 간격 자동 새로고침 기능 추가
- 기존 통계 API를 동일하게 호출

### 백엔드 확인 필요
- [ ] 통계 API에 rate limiting이 있다면, 5분 간격 자동 호출이 차단되지 않는지 확인
- [ ] 통계 데이터 캐싱 정책 확인 (5분 이내 재호출 시 캐시 응답 가능 여부)

---

## 7. [미진행] 법률 문서 메타정보 업데이트

### 현황
약관, 개인정보처리방침, 환불정책에 다음 플레이스홀더가 남아 있음:

| 항목 | 현재값 | 필요값 |
|------|--------|--------|
| 상호명 | [상호명] | 실제 상호 입력 |
| 대표자명 | [대표자명] | 실제 대표자 입력 |
| 사업자등록번호 | [000-00-00000] | 실제 번호 입력 |
| 주소 | [사업장 주소] | 실제 주소 입력 |
| 전화번호 | [전화번호] | 실제 전화번호 입력 |
| 시행일 | 2026년 4월 1일 | 런칭일에 맞춰 조정 |

### 대상 파일
- `src/components/legal/TermsContent.vue`
- `src/pages/refund-policy.vue`
- `src/pages/privacy.vue` (있는 경우)

### 요청
- [ ] 실제 사업자 정보 제공 시 프론트엔드에서 일괄 반영 예정

---

## 변경된 프론트엔드 파일 목록 (이번 작업)

### P0 - 가격 통일
- `src/components/legal/TermsContent.vue` - 약관 내 22,000→19,800 수정
- `src/pages/refund-policy.vue` - 환불정책 22,000→19,800, 계산 예시 수정

### P0 - 접근성 개선
- `src/plugins/vuetify/theme.js` - error 색상 #FF4D49→#D32F2F(라이트)/#EF5350(다크)
- `src/@core/scss/base/libs/vuetify/_overrides.scss` - caption 13px, focus-visible 복원

### P1 - 모바일 카드 뷰
- `src/pages/shop-admin/payment/history.vue` - 모바일 카드 뷰 추가
- `src/pages/shop-admin/business-settings/holidays.vue` - 모바일 카드 뷰 추가

### P1 - ARIA 라벨
- 주요 관리자 페이지에 aria-label 일괄 추가

### P1 - 코드 정리 (DRY)
- `src/composables/usePhoneValidation.js` - **신규** 전화번호 검증 유틸리티
- `src/composables/useFormRules.js` - **신규** 폼 검증 규칙 유틸리티
- `src/constants/reservation-status.js` - **신규** 예약 상태 상수

### P2 - 개선 작업
- `src/pages/shop-admin/statistics/index.vue` - 자동 새로고침 추가
- `src/pages/shop-admin/reservations/list.vue` - 과거/미래 예약 시각적 구분
- `src/assets/styles/styles.scss` - 버튼 44px 터치 영역
- `src/plugins/vuetify/theme.js` - 다크모드 대비 개선
- 이미지 최적화 (lazy loading, alt 텍스트)
